<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Committing Linked Tickets &mdash; Simulation Systems  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.59c74d8c95b765a7fd995ac71d459ebe.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/design-tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Curating a Release" href="curaterelease.html" />
    <link rel="prev" title="How To Commit" href="howtocommit.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Simulation Systems
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Working Practices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/working_practices.html">About the Working Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/planning_your_change.html">Planning Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/tickets.html">Create a ticket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/branches.html">Create a branch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/developing_change.html">Developing Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/testing.html">Testing Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/approvals.html">Approval Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/reviews.html">Reviews</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/final_steps.html">Final Steps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides for Reviewers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="scitechreview.html">Science and Technical Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="codereview.html">Code and System Review</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="howtocommit.html">How To Commit</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Committing Linked Tickets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-do-linked-tickets-work">How do linked tickets work?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#testing-linked-tickets">Testing linked tickets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#committinglinked">Committing linked tickets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="howtocommit.html#merge">1. Merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtocommit.html#macros-if-required">2. Macros (if required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtocommit.html#test-if-no-kgo">3. Test (if no KGO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtocommit.html#kgo-if-required">4. KGO (if required)</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtocommit.html#commit">5. Commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="howtocommit.html#close">6. Close</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="curaterelease.html">Curating a Release</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further Details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/who.html">Who’s Who</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/glossary.html">Simulation Systems Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/dos_donts.html">Do’s and Don’ts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/change_notes.html">Recent Changes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Simulation Systems</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="howtocommit.html">How To Commit</a></li>
      <li class="breadcrumb-item active">Committing Linked Tickets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Reviewers/committinglinkedtickets.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="committing-linked-tickets">
<span id="committinglinkedtickets"></span><h1>Committing Linked Tickets<a class="headerlink" href="#committing-linked-tickets" title="Permalink to this headline"></a></h1>
<section id="how-do-linked-tickets-work">
<h2>How do linked tickets work?<a class="headerlink" href="#how-do-linked-tickets-work" title="Permalink to this headline"></a></h2>
<p>Linked tickets contain changes that all need to be committed together to work
successfully. With only some of the changes committed the repositories are
considered “out of sync”, with some of the test suites likely to fail as the
api between the codebases is broken. For this reason, where possible, all parts of
a linked ticket should be committed on the same day to avoid nightly tests failing.</p>
<p><a class="reference internal" href="../WorkingPractices/multi_repository.html#multirepo"><span class="std std-ref">Multi-repository</span></a> changes are nested, and the different branches
will need approaching in the correct order. The UM and LFRIc are the key places where
these overlap.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Everything except UM and LFRic can be worked on seperately and should be committed first.</p></li>
<li><p>The UM relies on code from all of the above code bases, and will need that code for both testing and committing.</p></li>
<li><p>LFRic relies on code from all of the above, and will need that code for both testing and committing.</p></li>
</ol>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While it is possible to work through the commit process for each repository in turn,
following this list in order, this can take a lot of time and so it is prudent to
parallelise the process where possible.</p>
<p>A suggested sequence would be as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Complete the merge and macro stages for every repository. These steps are entirely
isolated and so order doesn’t matter.</p></li>
<li><p>Test all of the changes together as described below.</p></li>
<li><p>Install KGO files for all repositories requiring them</p></li>
<li><p>Commit the tickets as described below.</p></li>
</ol>
</div></blockquote>
</div>
</section>
<section id="testing-linked-tickets">
<span id="tesinglinked"></span><h2>Testing linked tickets<a class="headerlink" href="#testing-linked-tickets" title="Permalink to this headline"></a></h2>
<p>With the branches from all the tickets merged into a working copy of their
respective Head of Trunk these can all be used together to test the change.</p>
<p>Details for testing multi-repository tickets are included <a class="reference internal" href="../WorkingPractices/multi_repository.html#multirepo"><span class="std std-ref">here</span></a>.</p>
<p><strong>In summary:</strong></p>
<ul>
<li><p>JULES, UKCA and other child repositories can be tested using their standalone
test suites as described on the How to Commit page.</p></li>
<li><p>Local working copies can be passed to the UM on the command line</p>
<blockquote>
<div><div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>rose stem --group=developer,ukca,jules --source=. --source=/path/to/jules/working/copy --source=/path/to/ukca/working/copy
</pre></div>
</div>
<p>Make sure you test the group that will exercise the interface between those repositories
(e.g. in the above example the jules and ukca groups are tested).</p>
</div></blockquote>
</li>
<li><p>Local working copies of any linked UM, JULES, UKCA or other repositories
can be passed to LFRic through &lt;lfric_trunk&gt;/lfric_atm/fcm-make/parameters.sh.</p>
<blockquote>
<div><div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>um_sources=vldXXX:/path/to/um/working/copy
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is always important that branches and working copies used for testing
multiple repositories together have been taken at the same point in time. If
this isn’t the case then API breaking changes may be included in one repository
but not another which will cause tests to break.</p>
<p>The developer will likely have used branches taken from the last releases which
are a known set of stable revisions which work together.</p>
<p>Make sure the testing done here (just prior to commit) is using the latest
head of all the trunks. Assuming nightly tests are passing then this is
also a known set of revisions that work together.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If some of the changes in this set of tickets have already been committed
then see steps 2, 4 and 5 below on how to include those changes in your testing.
This is instead of the steps described above.</p>
<p>e.g. If JULES changes have been committed and the revision number modified in
rose-suite.conf then the working copy no longer needs supplying as a <cite>source</cite>
to the UM testing.</p>
</div>
</section>
<section id="committinglinked">
<span id="id1"></span><h2>Committing linked tickets<a class="headerlink" href="#committinglinked" title="Permalink to this headline"></a></h2>
<p>Once you are happy with all your testing then the commit sequence is as follows:</p>
<ol class="arabic">
<li><p>Commit all trunks <strong>except</strong> UM and LFRic. Make note of the commit revision numbers.</p></li>
<li><p>Update &lt;um_trunk&gt;/rose-stem/rose-suite.conf</p>
<blockquote>
<div><ul>
<li><p>Modify <code class="docutils literal notranslate"><span class="pre">HOST_SOURCE_*</span></code> for all child repositories involved to point to the new commit revisions.</p></li>
<li><p>e.g. If a JULES ticket has just been committed at revision 12345</p>
<blockquote>
<div><div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>HOST_SOURCE_JULES=&#39;fcm:jules.xm_tr@12345&#39;
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Commit UM</p></li>
<li><p>Update &lt;lfric_trunk&gt;/lfric_atm/fcm-make/parameters.sh</p>
<blockquote>
<div><ul>
<li><p>Modify <code class="docutils literal notranslate"><span class="pre">*_rev</span></code> variables for all other repositories you have updated to point to the the new commit revisions.</p></li>
<li><p>Remove any branch references from the <code class="docutils literal notranslate"><span class="pre">*_sources</span></code> variables.</p></li>
<li><p>e.g. If a JULES ticket has been committed at revision 12345 and a UM ticket at 123456</p>
<blockquote>
<div><div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>export um_rev=123456
export jules_rev=12345

export um_sources=
export jules_sources=
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p><strong>For changes including JULES and LFRic</strong> also update &lt;lfric_trunk&gt;/miniapps/lfric_coupled/rose-stem/app/fcm_make_river/rose-app.conf</p>
<blockquote>
<div><ul class="simple">
<li><p>Modify <code class="docutils literal notranslate"><span class="pre">JULES_SOURCE_VN</span></code> to also point to the same revision as parameters.sh.</p></li>
</ul>
</div></blockquote>
</li>
</ol>
<ol class="arabic simple" start="5">
<li><p>Commit LFRic</p></li>
</ol>
<p>You may choose to run a subset of tests before completing the UM and LFRic commits in turn to validate your changes.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="howtocommit.html" class="btn btn-neutral float-left" title="How To Commit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="curaterelease.html" class="btn btn-neutral float-right" title="Curating a Release" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Simulation Systems and Deployment Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>