<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Committing Linked Tickets &mdash; Simulation Systems  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.59c74d8c95b765a7fd995ac71d459ebe.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/design-tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Curating a Release" href="curaterelease.html" />
    <link rel="prev" title="How To Commit" href="howtocommit.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Simulation Systems
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Working Practices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/working_practices.html">About the Working Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/planning_your_change.html">Planning Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/tickets.html">Create a ticket</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/branches.html">Create a branch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/developing_change.html">Developing Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/testing.html">Testing Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/approvals.html">Approval Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/reviews.html">Reviews</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/final_steps.html">Final Steps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides for Reviewers</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="scitechreview.html">Science and Technical Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="codereview.html">Code and System Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtocommit.html">How To Commit</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Committing Linked Tickets</a></li>
<li class="toctree-l1"><a class="reference internal" href="curaterelease.html">Curating a Release</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further Details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/who.html">Who’s Who</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/glossary.html">Simulation Systems Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/dos_donts.html">Do’s and Don’ts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../WorkingPractices/change_notes.html">Recent Changes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Simulation Systems</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Committing Linked Tickets</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Reviewers/committinglinkedtickets.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="committing-linked-tickets">
<span id="committinglinkedtickets"></span><h1>Committing Linked Tickets<a class="headerlink" href="#committing-linked-tickets" title="Permalink to this headline"></a></h1>
<div class="sd-fs-5 docutils">
<p>First, checkout, merge and test all branches. Tests for each branch can run simultaneously, but give the Jules-ticket as a source to the UM, and give the UM and Jules tickets as sources to LFRic:</p>
</div>
<div class="sd-fs-5 docutils">
<p><strong>1. Checkout trunks, merge in tickets and test:</strong></p>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="7953ca83-ef57-4baa-b3af-464fe62a5825" name="b4cd60ce-7d38-416c-beba-ab433d3d4dde" type="radio">
</input><label class="sd-tab-label" for="7953ca83-ef57-4baa-b3af-464fe62a5825">
Jules</label><div class="sd-tab-content docutils">
<blockquote>
<div><p>Check out Jules trunk and merge:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm co fcm:jules.x_tr@HEAD your_directory_name
cd your_directory_name
fcm merge fcm:jules.x_br/dev/dev_name/branch_name
fcm conflicts
</pre></div>
</div>
<p>The before and after tag always cause conflicts in the versions.py file and need manually adjusting.
If this is the only conflict, you can edit with the GUI or manually afterwards. To edit manually, accept changes in the pop-up GUI window and put “y” in terminal when prompted.
Manually go to the “versions.py” file, add the old class back in/edit the file so both the old and new class are in, and change the before tag to be equal to the previous update’s after tag.</p>
</div></blockquote>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Upgrade macros, new rose stem app or KGO update?<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Upgrade macros:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>./bin/upgrade_jules_test_apps vnX.X_txxx
</pre></div>
</div>
</div>
</details><p>Test the Jules ticket:</p>
<blockquote>
<div><div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>rose stem --group=scripts
rose stem --group=all
</pre></div>
</div>
</div></blockquote>
</div>
<input id="408e8210-2154-470b-a765-78894e991bc2" name="b4cd60ce-7d38-416c-beba-ab433d3d4dde" type="radio">
</input><label class="sd-tab-label" for="408e8210-2154-470b-a765-78894e991bc2">
Jules docs</label><div class="sd-tab-content docutils">
<p>Checkout Jules doc trunk and merge:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm co fcm:jules_doc.x_tr@HEAD jules_doc
cd jules_doc
fcm merge fcm:jules_doc.x_br/dev/dev_name/branch_name
</pre></div>
</div>
<p>Check the documentation builds correctly:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>module load scitools
cd docs/user_guide
make clean html
firefox build/html/index.html &amp;

make clean latexpdf
evince build/latex/JULES_User_Guide.pdf &amp;
</pre></div>
</div>
</div>
<input id="e5a0a024-cfe5-45b6-94e0-b218e5ccf993" name="b4cd60ce-7d38-416c-beba-ab433d3d4dde" type="radio">
</input><label class="sd-tab-label" for="e5a0a024-cfe5-45b6-94e0-b218e5ccf993">
UM</label><div class="sd-tab-content docutils">
<p>Checkout the UM trunk, merge with the ticket, check for conflicts:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm co fcm:um.x_tr chosen_name
cd chosen_name
fcm merge fcm:um.x_br/dev/dev_name/branch_name
fcm cf
</pre></div>
</div>
<p>The before and after tag always cause conflicts in the versions.py file and need manually adjusting.
If this is the only conflict, you can edit with the GUI or manually afterwards. To edit manually, accept changes in the pop-up GUI window and put “y” in terminal when prompted.
Manually go to the “versions.py” file, add the old class back in/edit the file so both the old and new class are in, and change the before tag to be equal to the previous update’s after tag.</p>
<p>Update the test suite for an upgrade macro, where <em>xx.x</em> is the UM version and <em>xxxxx</em> is the AFTER_TAG of the upgrade macro:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>~frum/bin/update_all.py /path/to/working/copy/of/trunk --um=xx.x_xxxxx
</pre></div>
</div>
<p>Test UM with a source pointing to Jules, to include the Jules updates in the testing:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>rose stem --group=developer,jules --source=. --source=/path/to/merged/jules/working/copy
</pre></div>
</div>
</div>
<input id="531dada3-d10d-4028-a5a7-04c551eeecd3" name="b4cd60ce-7d38-416c-beba-ab433d3d4dde" type="radio">
</input><label class="sd-tab-label" for="531dada3-d10d-4028-a5a7-04c551eeecd3">
LFRic</label><div class="sd-tab-content docutils">
<p>Checkout the UM trunk, merge with the ticket, check for conflicts:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm co fcm:lfric.x_tr your_lfric_trunk_name
cd your_lfric_trunk_name
fcm merge fcm:lfric.x_br/dev/dev_name/branch_name
fcm cf
</pre></div>
</div>
<p>Navigate into: chosen_name/lfric atm/fcm-make/parameters.sh and temporarily change the UM and Jules sources to:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>vldxxx:/path/to/um _ticket
vldxxx:/path/to/ jules_ticket
</pre></div>
</div>
<p>Back in the terminal, test the changes:</p>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>cd lfric_atm
module use /data/users/lfric/modules/modulefiles.rhel7
module load environment/lfric/intel
make test-suite
</pre></div>
</div>
</div>
</div>
<div class="sd-fs-5 docutils">
<p><strong>2. Committing tickets</strong></p>
</div>
<p>N.B. Tickets must be committed in the correct order: Jules, then UM, then LFRic:</p>
<ol class="arabic simple">
<li><p>Commit Jules ticket (and then Jules documentation)</p></li>
</ol>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm commit
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Put JULES revision number into UM rose-stem/rose-suite.conf</p></li>
</ol>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>cd ticket_folder/rose-stem/rose-suite.conf
</pre></div>
</div>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>BASE_JULES_REV=&#39;xxxxx&#39;
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Commit UM ticket</p></li>
</ol>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm commit
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Put JULES and UM revision numbers into LFRic’s lfric_atm/fcm-make/parameters.sh file, and remove paths to working copies in that file.</p></li>
</ol>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>export um_rev=xxxxx
export jules_rev=xxxxxx

export um_sources=
export jules_sources=
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Commit LFRic ticket</p></li>
</ol>
<div class="highlight-RST notranslate"><div class="highlight"><pre><span></span>fcm commit
</pre></div>
</div>
<p>Now remember to:  Update the ticket with the revision number the change was merged back into the trunk at, e.g. [500] for revision 500, and comment whether the change is expected to alter results or not and update the ticket status to committed.</p>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="howtocommit.html" class="btn btn-neutral float-left" title="How To Commit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="curaterelease.html" class="btn btn-neutral float-right" title="Curating a Release" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Simulation Systems and Deployment Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>