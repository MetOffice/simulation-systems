<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Some basic guidance on Rose metadata &mdash; Simulation Systems  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/design-tabs.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Upgrade Macros" href="macros.html" />
    <link rel="prev" title="Input Variables, Rose Metadata and Upgrade Macros" href="inputs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Simulation Systems
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Working Practices</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="working_practices.html">About the Working Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="planning_your_change.html">Planning Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="tickets.html">Create a ticket</a></li>
<li class="toctree-l1"><a class="reference internal" href="branches.html">Create a branch</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="developing_change.html">Developing Your Change</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="documentation.html">Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="inputs.html">Input Variables, Rose Metadata and Upgrade Macros</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="inputs.html#how-to-add-an-upgrade-macro-to-your-branch">How to add an upgrade macro to your branch</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Some basic guidance on Rose metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="macros.html">Upgrade Macros</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="kgo.html">Known Good Output (KGO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagnostics.html">Diagnostic Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="rose_stem.html">Rose Stem Suite</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing Your Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_repository.html">Working with Multiple Repositories</a></li>
<li class="toctree-l1"><a class="reference internal" href="approvals.html">Approval Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="reviews.html">Reviews</a></li>
<li class="toctree-l1"><a class="reference internal" href="final_steps.html">Final Steps</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guides for Reviewers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Reviewers/scitechreview.html">Science and Technical Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reviewers/codereview.html">Code and System Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reviewers/howtocommit.html">How To Commit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reviewers/curaterelease.html">Curating a Release</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further Details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="who.html">Who’s Who</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Simulation Systems Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="dos_donts.html">Do’s and Don’ts</a></li>
<li class="toctree-l1"><a class="reference internal" href="change_notes.html">Recent Changes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Simulation Systems</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="developing_change.html">Developing Your Change</a></li>
          <li class="breadcrumb-item"><a href="inputs.html">Input Variables, Rose Metadata and Upgrade Macros</a></li>
      <li class="breadcrumb-item active">Some basic guidance on Rose metadata</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/WorkingPractices/metadata_guidance.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="metadata-guidance"></span><section id="some-basic-guidance-on-rose-metadata">
<h1>Some basic guidance on Rose metadata<a class="headerlink" href="#some-basic-guidance-on-rose-metadata" title="Permalink to this heading"></a></h1>
<p>It is important that the appearance of inputs across the GUI panels conform to the same standards.
This ensures that users of each model become familiar with how the panels work and are present
with a consistent set of information, such as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[namelist:&lt;namelist&gt;=&lt;variable&gt;]
description=&lt;what is the variable for?&gt;
help=&lt;detailed information about the variable&gt;
sort-key=&lt;XY&gt;
url=&lt;http://jules-lsm.github.io/latest/namelists/&lt;namelist&gt;.nml.html#&lt;NAMELIST&gt;::&lt;item&gt;&gt;
etc
</pre></div>
</div>
<p>where JULES namelist items should only contain the <code class="docutils literal notranslate"><span class="pre">url=</span></code> field and
not the <code class="docutils literal notranslate"><span class="pre">help=</span></code> field regardless of the repository they reside
in. Each input is presented in the GUI as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="n">name</span>
<span class="n">short</span> <span class="n">description</span> <span class="n">of</span> <span class="n">the</span> <span class="n">variable</span> <span class="n">name</span>
</pre></div>
</div>
<p>Either the help text is displayed or web help opened when one clicks
the variable name. If both fields exist the Web help is opened
preferentially. If a <code class="docutils literal notranslate"><span class="pre">url=</span></code> is present the <code class="docutils literal notranslate"><span class="pre">help=</span></code> field should be
removed to avoid duplication.</p>
<section id="shared-namelists">
<span id="id1"></span><h2>Shared namelists<a class="headerlink" href="#shared-namelists" title="Permalink to this heading"></a></h2>
<p>Shared namelist items, or items which exist in more than one
repository, should have identical metadata regardless of the
repository where they reside (e.g. JULES items in the UM
metadata). The only caveats are where a <code class="docutils literal notranslate"><span class="pre">trigger</span></code> or a <code class="docutils literal notranslate"><span class="pre">fail-if</span></code>
reference a namelist item from the parent model (e.g. UM).</p>
<p>Shared JULES metadata is in the process of being migrated to
<a class="reference external" href="https://code.metoffice.gov.uk/trac/jules/browser/main/trunk/rose-meta/jules-shared">rose-meta/jules-shared</a>,
which resides in the JULES repository. The sub-directories are
imported by <strong>rose-meta/um-atmos</strong> and <strong>rose-meta/jules-standalone</strong>
and is manually synced with a copy in LFRic. Please see <a class="reference external" href="https://code.metoffice.gov.uk/trac/jules/wiki/SharingJULESmetadata">Sharing JULES
metadata</a>
for more details including what should be in <a class="reference external" href="https://code.metoffice.gov.uk/trac/jules/wiki/SharingJULESmetadata#Whatsinjules-shared">jules-shared</a>
and in <a class="reference external" href="https://code.metoffice.gov.uk/trac/jules/wiki/SharingJULESmetadata#Whatsinjules-standalonejules-lfricorum-atmos">jules-standalone, jules-lfric or um-atmos</a>. When
developing shared JULES metadata, you will need <a class="reference internal" href="multi_repository.html#multirepo"><span class="std std-ref">linked tickets</span></a>. The metadata migration is currently dictated by LFRic
porting of science, although the ultimate aim is to have a single
source of truth.</p>
<p>Please see the <a class="reference internal" href="#metadata-changes"><span class="std std-ref">rose config-edit example</span></a> for
an illustration of how to pick up <strong>jules-shared</strong> changes from a
JULES working copy.</p>
<p>The following sections provide some general guidance as to how to structure your metadata.</p>
</section>
<section id="number-of-panels">
<h2>Number of panels<a class="headerlink" href="#number-of-panels" title="Permalink to this heading"></a></h2>
<p>If you have a particularly long namelist, consider dividing up the number of panels to ensure
that the user doesn’t have to deal with a particularly long panel with lots of switches.
However, switches which relate to each other should always be on the same panel.</p>
</section>
<section id="sort-keys-and-triggers">
<h2>Sort Keys and triggers<a class="headerlink" href="#sort-keys-and-triggers" title="Permalink to this heading"></a></h2>
<p>Please use sort-keys to order the appearance of items in your panels, otherwise they will appear
in alphabetical order. This means that sometimes items that are triggered on and off will appear
far away from the item that triggered them.</p>
<p>Please provide triggers for all variables where possible. It is much better and cleaner to only
see inputs that need to be set rather than everything.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The GUI provides an option to un-hide triggered variables if one wants to see them all.</p>
</div>
<p>Please set <code class="docutils literal notranslate"><span class="pre">compulsory=true</span></code> for items and use triggers for when it
is not required. The settings
of all variables will then be present, in all apps to aid configuration management. When a variable
is triggered off, it will be commented out in the apps e.g. <code class="docutils literal notranslate"><span class="pre">!!variable</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If any variable (new or existing) has received a new compulsory=true setting please use an upgrade macro to
add that variable to apps with a valid value.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While it is possible to trigger a variable based on <code class="docutils literal notranslate"><span class="pre">AND</span></code> logic (e.g. where some condition on <code class="docutils literal notranslate"><span class="pre">variable1</span></code>
and another condition on <code class="docutils literal notranslate"><span class="pre">variable2</span></code> trigger <code class="docutils literal notranslate"><span class="pre">variable3</span></code>), cumbersome triggering of this nature is best
avoided.</p>
<p>It is not possible to trigger a variable based on <code class="docutils literal notranslate"><span class="pre">OR</span></code> logic.</p>
</div>
</section>
<section id="viewing-metadata-changes-as-you-go-along">
<span id="metadata-changes"></span><h2>Viewing metadata changes as you go along<a class="headerlink" href="#viewing-metadata-changes-as-you-go-along" title="Permalink to this heading"></a></h2>
<p>One can easily review their metadata changes with the rose config editor, opening up an example app file. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">of</span> <span class="n">working</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">branch</span><span class="o">&gt;/</span><span class="n">rose</span><span class="o">-</span><span class="n">stem</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">um_n48_eg</span>
<span class="n">rose</span> <span class="n">config</span><span class="o">-</span><span class="n">edit</span> <span class="o">-</span><span class="n">M</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">of</span> <span class="n">working</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">branch</span><span class="o">/</span><span class="n">rose</span><span class="o">-</span><span class="n">meta</span><span class="o">/&gt;</span>
</pre></div>
</div>
<p>If making <strong>jules-shared</strong> changes, when reviewing these changes from a
different parent repository, you will first need to set the
<cite>ROSE_META_PATH</cite> system variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ROSE_META_PATH</span><span class="o">=&lt;</span><span class="n">path</span> <span class="n">of</span> <span class="n">working</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">JULES</span> <span class="n">branch</span><span class="o">/</span><span class="n">rose</span><span class="o">-</span><span class="n">meta</span><span class="o">/&gt;</span>
</pre></div>
</div>
<p>or add the path instead as a colon separated list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rose</span> <span class="n">config</span><span class="o">-</span><span class="n">edit</span> <span class="o">-</span><span class="n">M</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">of</span> <span class="n">working</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">branch</span><span class="o">/</span><span class="n">rose</span><span class="o">-</span><span class="n">meta</span><span class="o">/&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">path</span> <span class="n">of</span> <span class="n">working</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">JULES</span> <span class="n">branch</span><span class="o">/</span><span class="n">rose</span><span class="o">-</span><span class="n">meta</span><span class="o">/&gt;</span>
</pre></div>
</div>
<p>then once the app opens click on the LHS appname to display the app
meta panel. Update this to HEAD rather than the version number and
apply.</p>
<p>Please note that if you have used an upgrade macro on the app then the
meta line at the top of the app file will have changed
(e.g. meta=um-atmos/vn11.0_t46). Since no metadata exists at this
version rose edit will produce an error saying that it cannot find it,
instead it will use the metadata in e.g. um-atmos/HEAD. Please click
OK and continue.</p>
<p>Your updates should now appear.</p>
</section>
<section id="ensuring-metadata-changes-are-valid">
<h2>Ensuring metadata changes are valid<a class="headerlink" href="#ensuring-metadata-changes-are-valid" title="Permalink to this heading"></a></h2>
<p>Developments to the metadata can be checked for errors by running
<a class="reference external" href="https://metomi.github.io/rose/doc/html/api/command-reference.html#rose-metadata-check">rose metadata-check</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rose</span> <span class="n">metadata</span><span class="o">-</span><span class="n">check</span> <span class="o">-</span><span class="n">C</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">rose</span><span class="o">-</span><span class="n">meta</span><span class="o">/&lt;</span><span class="n">config</span><span class="o">&gt;/</span><span class="n">HEAD</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">-C</span></code> option can be omitted if inside the directory containing the metadata file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If there are <strong>jules-shared</strong> changes then these need to be
added to the metadata path even in the JULES repository. As the
metadata checker does not have the <code class="docutils literal notranslate"><span class="pre">-M</span></code> option, this has to be
done using the <cite>ROSE_META_PATH</cite> environnment variable as in the
<a class="reference internal" href="#metadata-changes"><span class="std std-ref">previous example</span></a>.</p>
<p>If the metadata checker returns “not a configuration metadata
directory” then this may indicate that the wrong path has been
set.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="inputs.html" class="btn btn-neutral float-left" title="Input Variables, Rose Metadata and Upgrade Macros" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="macros.html" class="btn btn-neutral float-right" title="Upgrade Macros" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, Simulation Systems and Deployment Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>